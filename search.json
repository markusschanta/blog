[
  {
    "objectID": "posts/2022-world-cup-start/index.html",
    "href": "posts/2022-world-cup-start/index.html",
    "title": "Who Will Win the World Cup? A Quantitative Approach.",
    "section": "",
    "text": "This year’s world cup seems a bit like the dish that nobody ordered. Inconvenient ethical questions aside, the world cup is traditionally one of the events around which the highest volume of sports betting is transacted. To put things into perspective, on the seemingly bland question “Will Ecuador reach the Quarter Final?”, more than 5,084 Euros have been wagered on one online betting platform alone. For all of the games of the FIFA World Cup, more than 10 million euros worth of bets have been placed on the same platform. As a data scientist, it’s exciting to observe how all of that punting, in aggregate, produces a quite comprehensive collective valuation of the chances of success for each of the teams.\nThe big question is of course: “Who will win the World Cup?” Crunching the numbers, one can work out the implicit probabilities in the odds offered for each team. As of 9 am today, the odds were as follows:\n\n\nCode\nimport altair as alt\nimport pandas as pd\n\nSTAGE_ORDER = ['win', 'final', 'semi', 'quarter', 'qualify']\nSTAGE_ORDER_MAP = {v: k for k, v in enumerate(STAGE_ORDER[::-1])}\n\nSTAGE_NAME_MAP = {\n    \"win\": \"Win the Tournament\",\n    \"final\": \"Reach the Finals\",\n    \"semi\": \"Reach the Semi-Finals\",\n    \"quarter\": \"Reach the Quarter-Finals\",\n    \"qualify\": \"Reach the Round of 16\"\n}\n\nlast = pd.read_csv('teams.20221120.csv')\n\nchart = last.copy().loc[:, ['country', 'p', 'stage']]\nchart['stage_order'] = chart.stage.apply(lambda b: STAGE_ORDER_MAP[b])\nchart['stage_nice'] = chart.stage.apply(lambda b: STAGE_NAME_MAP[b])\nchart['y'] = 0\nchart = chart.sort_values('stage_order')\n\ncountry_order = list(chart[chart.stage == 'win'].sort_values('p', ascending=False)['country'])\n\nalt.Chart(chart[chart.stage == 'win']).mark_bar(size=12).encode(\n    x=alt.X('country:O', axis=alt.Axis(title=\"\"), sort=country_order),\n    y=alt.Y('p:Q', axis=alt.Axis(title=\"Probability\", format=\"%\")),\n    y2='y',\n    color=alt.Color(\n        field='stage_nice', type='ordinal', sort=[STAGE_NAME_MAP[b] for b in STAGE_ORDER][::-1],\n        legend=None, scale=alt.Scale(scheme='greens')\n    ),\n    tooltip = [\n        alt.Tooltip('country', title=\"Country\"), \n        alt.Tooltip('p', title=\"Probability to Win\", format=\".2%\")\n    ]\n).properties(\n    width={\"step\": 16}\n)\n\n\n\n\n\n\n\nTo work out how these odds are derived, consider the following: As of today, bookmakers are offering to bet on Brazil winning the tournament with a payout of 4.4 times the wager. To bet against Brazil winning the tournament is offered at odds of 4.5. To come up with a probability, we first take the midpoint of those two numbers, which is 4.45. We then invert that number and we get an implied probability of precisely 22.4719% for Brazil to win the World Cup.\nAs mentioned, there are a lot more events that people can and do bet on. From those, it is possible to determine the odds of any team reaching the round of 16, quarter-finals, semi-finals and finals. All of these odds for each team are shown in the chart below:\n\n\nCode\nalt.Chart(chart).mark_bar(size=12).encode(\n    x=alt.X('country:O', axis=alt.Axis(title=\"\"), sort=country_order),\n    y=alt.Y('p:Q', axis=alt.Axis(title=\"Probability\", format=\"%\")),\n    y2='y',\n    color=alt.Color(\n        field='stage_nice', type='ordinal', sort=[STAGE_NAME_MAP[b] for b in STAGE_ORDER][::-1],\n        legend=alt.Legend(title=\"Position\"), scale=alt.Scale(scheme='greens')\n    ),\n    tooltip = [\n        alt.Tooltip('country', title=\"Country\"),\n        alt.Tooltip('stage_nice', title=\"Position\"),\n        alt.Tooltip('p', title=\"Probability\", format=\".2%\")\n    ]\n).properties(\n    width={\"step\": 16}\n)\n\n\n\n\n\n\n\nOne thing that stands out here is that the probability ratios between these outcomes are not exactly the same for each team. Take Serbia and Ecuador for example: Serbia has a 1.0% implied chance of winning the tournament, while Ecuador has a 0.4% chance. Despite the better odds to win the tournament, Serbia has a 47.4% chance of qualifying for the round of 16, while Ecuador has a 46.9% chance. This is because Serbia is in a particularly strong group, while Ecuador is in a relatively weak group. Below are the cumulative probabilities of winning the tournament per each group:\n\n\nCode\ngroups = last[last.stage == 'qualify'].rename(columns = {'bet': 'group'})[['country', 'group']]\ngroups = last.merge(groups, left_on='country', right_on='country')\n\nwin = groups[groups.bet == 'win']\nby_group_chart = win.groupby('group').sum().reset_index()\n\ny = by_group_chart.sort_values('p', ascending=False).reset_index(drop='true').reset_index().loc[:, ['group', 'index']]\ny.columns = ['group', 'y']\n\nx = win.groupby('group').apply(lambda x: x.reset_index().reset_index()[['country', 'level_0']]).reset_index(drop=True)\nx.columns = ['country', 'x']\n\nsquare = win.merge(x, left_on='country', right_on='country')\nsquare = square.merge(y, left_on='group', right_on='group')\n\nlabels = alt.Chart(square).mark_text(baseline=\"middle\").encode(\n    x=alt.X('x:O', axis=alt.Axis(title='', ticks=False, labels=False, grid=False, domain=False)),\n    y=alt.Y('y:O', axis=alt.Axis(title='', ticks=False, labels=False, grid=False, domain=False)),\n    text='country',\n).properties(\n    width=250,\n    height=200\n)\n\nbars = by_group_chart.copy()\nbars.group = bars.group.apply(lambda s: \"Group \" + s.upper())\n\nbars = alt.Chart(bars).mark_bar().encode(\n    x=alt.X('p:Q', axis=alt.Axis(title=\"Combined Probability to Win\", format=\"%\")),\n    y=alt.Y('group:N', axis=alt.Axis(title=\"\",), sort='-x'),\n    color=alt.Color(field='foo', legend=None, scale=alt.Scale(scheme='greens')),\n    tooltip = [\n        alt.Tooltip('group', title=\"Group\"), \n        alt.Tooltip('p', title=\"Combined Probability to Win\", format=\".2%\")\n    ]\n).properties(\n    width=400,\n    height=200\n)\n\n(labels | bars).configure_axisY(\n    labelFontSize=11\n).configure_view(\n    stroke = \"white\"\n)\n\n\n\n\n\n\n\nOne final thing one might wonder about is who’s going to emerge as the tournament’s top goal scorer. On this one, Tottenham striker Harry Kane seems to be the consensus favourite after already winning the Golden Boot at the 2018 FIFA World Cup, followed by Kylian Mbappe and Lionel Messi:\n\n\nCode\ngoalscorer = pd.read_csv('goalscorer.20221120.csv').sort_values('p', ascending=False)\n\nalt.Chart(goalscorer.iloc[:40]).mark_bar(size=12).encode(\n    x=alt.X('country:O', axis=alt.Axis(title=\"Player\"), sort='-y'),\n    y=alt.Y('p:Q', axis=alt.Axis(title=\"Probability\", format=\"%\")),\n    # y2='y',\n    color=alt.Color(\n        field='stage_nice', type='ordinal', sort=[STAGE_NAME_MAP[b] for b in STAGE_ORDER][::-1],\n        legend=None, scale=alt.Scale(scheme='greens')\n    ),\n    tooltip = [\n        alt.Tooltip('country', title=\"Player\"), \n        alt.Tooltip('p', title=\"Probability\", format=\".2%\")\n    ]\n).properties(\n    width={\"step\": 16}\n)\n\n\n\n\n\n\n\nThe World Cup kicks off tomorrow with the classic crowd-pleaser Qatar v Ecuador. We will see whether the host nation will be able to turn the 9.8% odds of winning in their favour. Maybe instead the Ecuadorians can capitalise on their 68.3% implied probability of winning the game or at least achieve the draw that has a 21.9% probability. Time will tell! Until then you can follow this blog for more quantitative analysis of the World Cup and updates about how these probabilities shift as the events unfold."
  },
  {
    "objectID": "posts/land-prices-austria/index.html",
    "href": "posts/land-prices-austria/index.html",
    "title": "Land Prices in Austria",
    "section": "",
    "text": "A map with the average price per square meters of building land for all Austrian munucipalities.\nThe map below shows the average price per square meters of building land for all Austrian munucipalities (Gemeinden) as per 2020.\n\n\nCode\nimport altair as alt\nimport pandas as pd\n\npreise_url = \"https://www.statistik.at/wcm/idc/idcplg?IdcService=GET_NATIVE_FILE&RevisionSelectionMethod=LatestReleased&dDocName=126150\"\npreise_urls = {\n    \"2016\": \"https://raw.githubusercontent.com/markusschanta/mslib/master/mslib/data/baugrundstueckspreise/files/baugrundstueckspreise_2016.xlsx\",\n    \"2017\": \"https://raw.githubusercontent.com/markusschanta/mslib/master/mslib/data/baugrundstueckspreise/files/baugrundstueckspreise_2017.xlsx\",\n    \"2018\": \"https://raw.githubusercontent.com/markusschanta/mslib/master/mslib/data/baugrundstueckspreise/files/baugrundstueckspreise_2018.xlsx\",\n    \"2019\": \"https://raw.githubusercontent.com/markusschanta/mslib/master/mslib/data/baugrundstueckspreise/files/baugrundstueckspreise_2019.xlsx\",\n    \"2020\": \"https://raw.githubusercontent.com/markusschanta/mslib/master/mslib/data/baugrundstueckspreise/files/baugrundstueckspreise_2020.xlsx\"\n}\n\ngemeinden_url = \"https://raw.githubusercontent.com/ginseng666/GeoJSON-TopoJSON-Austria/master/2021/simplified-99.5/gemeinden_995_topo.json\"\ngemeinden = alt.topo_feature(gemeinden_url, \"gemeinden\")\n\ndef get_preise(year):\n    xl = pd.ExcelFile(preise_urls[year], engine='openpyxl')\n    combined = []\n    for s in xl.sheet_names:\n        sheet = pd.read_excel(xl, engine='openpyxl', header=3, sheet_name=s)\n        sheet = sheet.iloc[:, -3:]\n        sheet.columns = ['iso', 'name', 'price']\n        combined.append(sheet.loc[~sheet.iso.isnull()])\n    return pd.concat(combined).reset_index(drop=True)\n\npreise = get_preise(\"2020\")\n# preise.price = preise.price.clip(upper=300)\n\nc = alt.Chart(gemeinden).mark_geoshape().encode(\n    color=alt.Color('price:Q', title='Price', scale=alt.Scale(domain=[8, 2000], type='log', scheme='spectral', reverse=True)),\n    tooltip=['name:N','price:Q']\n).transform_lookup(\n    lookup='properties.iso',\n    from_=alt.LookupData(preise, 'iso', ['price', 'name'])\n).properties(\n    width=600,\n    height=310\n)\n\nc"
  },
  {
    "objectID": "posts/altair-interactive-weather/index.html",
    "href": "posts/altair-interactive-weather/index.html",
    "title": "Interactive Weather Chart with Altair",
    "section": "",
    "text": "Code\nimport altair as alt\nfrom vega_datasets import data\nimport pandas as pd\n\nsource = data.seattle_weather()\n\nscale = alt.Scale(domain=['sun', 'fog', 'drizzle', 'rain', 'snow'],\n                  range=['#e7ba52', '#a7a7a7', '#aec7e8', '#1f77b4', '#9467bd'])\ncolor = alt.Color('weather:N', scale=scale)\n\n# We create two selections:\n# - a brush that is active on the top panel\n# - a multi-click that is active on the bottom panel\nbrush = alt.selection_interval(encodings=['x'])\nclick = alt.selection_multi(encodings=['color'])\n\n# Top panel is scatter plot of temperature vs time\npoints = alt.Chart().mark_point().encode(\n    alt.X('monthdate(date):T', title='Date',\n          scale=alt.Scale(domain=[pd.Timestamp(2012, 1, 1), pd.Timestamp(2012, 12, 31)])),\n    alt.Y('temp_max:Q',\n        title='Maximum Daily Temperature (C)',\n        scale=alt.Scale(domain=[-5, 40])\n    ),\n    color=alt.condition(brush, color, alt.value('lightgray')),\n    size=alt.Size('precipitation:Q', scale=alt.Scale(range=[5, 200]))\n).properties(\n    width=550,\n    height=300\n).add_selection(\n    brush\n).transform_filter(\n    click\n)\n\n# Bottom panel is a bar chart of weather type\nbars = alt.Chart().mark_bar().encode(\n    x='count()',\n    y='weather:N',\n    color=alt.condition(click, color, alt.value('lightgray')),\n).transform_filter(\n    brush\n).properties(\n    width=550,\n).add_selection(\n    click\n)\n\nalt.vconcat(\n    points,\n    bars,\n    data=source,\n    title=\"Seattle Weather: 2012-2015\"\n)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Markus Schanta",
    "section": "",
    "text": "Who Will Win the World Cup? A Quantitative Approach.\n\n\n\n\n\n\n\npython\n\n\naltair\n\n\nvisualisation\n\n\nfootball\n\n\n\n\n2022 FIFA World Cup betting odds and what they tell us about each team’s likelyhood to succeed.\n\n\n\n\n\n\nNov 19, 2022\n\n\n\n\n\n\n  \n\n\n\n\nLand Prices in Austria\n\n\n\n\n\n\n\npython\n\n\naltair\n\n\nvisualisation\n\n\naustria\n\n\n\n\n\n\n\n\n\n\n\nNov 17, 2022\n\n\n\n\n\n\n  \n\n\n\n\nInteractive Weather Chart with Altair\n\n\n\n\n\n\n\npython\n\n\naltair\n\n\nvisualisation\n\n\n\n\nCreating an interactive chart that combines maximum daily temperature, percipitation, date, type of weather and allows interactive filtering.\n\n\n\n\n\n\nNov 15, 2022\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "privacy.html",
    "href": "privacy.html",
    "title": "Privacy Information / Datenschutzerklärung",
    "section": "",
    "text": "In folgender Datenschutzerklärung informieren wir Sie über die wichtigsten Aspekte der Datenverarbeitung im Rahmen unserer Webseite. Wir erheben und verarbeiten personenbezogene Daten nur auf Grundlage der gesetzlichen Bestimmungen (Datenschutzgrundverordnung, Telekommunikationsgesetz 2003).\nSobald Sie als Benutzer auf unsere Webseite zugreifen oder diese besuchen wird Ihre IP-Adresse, Beginn sowie Beginn und Ende der Sitzung erfasst. Dies ist technisch bedingt und stellt somit ein berechtigtes Interesse iSv Art 6 Abs 1 lit f DSGVO.\nKontakt mit uns Wenn Sie uns, entweder über unser Kontaktformular auf unserer Webseite, oder per Email kontaktieren, dann werden die von Ihnen an uns übermittelten Daten zwecks Bearbeitung Ihrer Anfrage oder für den Fall von weiteren Anschlussfragen für sechs Monate bei uns gespeichert. Es erfolgt, ohne Ihre Einwilligung, keine Weitergabe Ihrer übermittelten Daten.\nCookies\nUnsere Website verwendet so genannte Cookies. Dabei handelt es sich um kleine Textdateien, die mit Hilfe des Browsers auf Ihrem Endgerät abgelegt werden. Sie richten keinen Schaden an. Wir nutzen Cookies dazu, unser Angebot nutzerfreundlich zu gestalten. Einige Cookies bleiben auf Ihrem Endgerät gespeichert, bis Sie diese löschen. Sie ermöglichen es uns, Ihren Browser beim nächsten Besuch wiederzuerkennen. Wenn Sie dies nicht wünschen, so können Sie Ihren Browser so einrichten, dass er Sie über das Setzen von Cookies informiert und Sie dies nur im Einzelfall erlauben. Bei der Deaktivierung von Cookies kann die Funktionalität unserer Website eingeschränkt sein.\nGoogle Fonts Unsere Website verwendet Schriftarten von „Google Fonts“. Der Dienstanbieter dieser Funktion ist:\nGoogle Ireland Limited\nGordon House, Barrow Street\nDublin 4\nIreland\nTel: +353 1 543 1000\nBeim Aufrufen dieser Webseite lädt Ihr Browser Schriftarten und speichert diese in den Cache. Da Sie, als Besucher der Webseite, Daten des Dienstanbieters empfangen kann Google unter Umständen Cookies auf Ihrem Rechner setzen oder analysieren.\nDie Nutzung von „Google-Fonts“ dient der Optimierung unserer Dienstleistung und der einheitlichen Darstellung von Inhalten. Dies stellt ein berechtigtes Interesse im Sinne von Art. 6 Abs. 1 lit. f DSGVO dar.\nWeitere Informationen zu Google Fonts erhalten Sie unter folgendem Link: https://developers.google.com/fonts/faq\nWeitere Informationen über den Umgang mit Nutzerdaten von Google können Sie der Datenschutzerklärung entnehmen: https://policies.google.com/privacy?hl=de\nGoogle verarbeitet die Daten auch in den USA, hat sich jedoch dem EU-US Privacy-Shield unterworfen: https://www.privacyshield.gov/EU-US-Framework\nServer-Log Files\nDiese Webseite und der damit verbundene Provider erhebt im Zuge der Webseitennutzung automatisch Informationen im Rahmen sogenannter „Server-Log Files“. Dies betrifft insbesondere:\n\n\nIP-Adresse oder Hostname\n\n\nden verwendeten Browser\n\n\nAufenthaltsdauer auf der Webseite sowie Datum und Uhrzeit\n\n\naufgerufene Seiten der Webseite\n\n\nSpracheinstellungen und Betriebssystem\n\n\nLeaving-Page\n\n\nISP (Internet Service Provider)\n\n\nDiese erhobenen Informationen werden nicht personenbezogen verarbeitet oder mit personenbezogenen Daten in Verbindung gebracht.\nDer Webseitenbetreiber behält es sich vor, im Falle von Bekanntwerden rechtswidriger Tätigkeiten, diese Daten auszuwerten oder zu überprüfen.\nNewsletter\nSie haben die Möglichkeit, über unsere Website unseren Newsletter zu abonnieren. Hierfür benötigen wir Ihre E-Mail-Adresse und ihre Erklärung, dass Sie mit dem Bezug des Newsletters einverstanden sind.\nWenn Sie die Möglichkeit nutzen unseren Newsletter zu abonnieren, wird Ihre Email-Adresse und Ihre Zustimmung/Einverständniserklärung über den Bezug des Newsletters benötigt. In Folge auf die Anmeldung zu unserem Newsletter, erhalten Sie von uns ein Bestätigungs-Email mit einem Link zur Anmeldebestätigung. Eine Stornierung des Abos ist jederzeit möglich.\nIhre Daten im Zusammenhang mit dem Newsletter-Versand werden im Falle einer Stornierung umgehend von uns gelöscht. Die Rechtmäßigkeit der erfolgten Datenverarbeitung bis zum Widerruf, welche aufgrund der Zustimmung passiert ist, wird nicht berührt.\nIhre Rechte als Betroffener\nSie als Betroffener haben bezüglich Ihrer Daten, welche bei uns gespeichert sind grundsätzlich ein Recht auf:\n\n\nAuskunft\n\n\nLöschung der Daten\n\n\nBerichtigung der Daten\n\n\nÜbertragbarkeit der Daten\n\n\nWiederruf und Widerspruch zur Datenverarbeitung\n\n\nEinschränkung\n\n\nWenn sie vermuten, dass im Zuge der Verarbeitung Ihrer Daten Verstöße gegen das Datenschutzrecht passiert sind, so haben Sie die Möglichkeit sich bei uns oder der Datenschutzbehörde zu beschweren."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "legal.html",
    "href": "legal.html",
    "title": "Legal Information / Impressum",
    "section": "",
    "text": "Informationen und Offenlegung gemäß §5 (1) ECG, § 25 MedienG, § 63 GewO und § 14 UGB\n\n\nWebseitenbetreiber\n\n\nMarkus Schanta\n\n\nKontaktdaten\n\n\n@markusschanta\n\n\nAnwendbare Rechtsvorschrift\n\n\nwww.ris.bka.gv.at\n\n\nOnline Streitbeilegung\n\n\nVerbraucher, welche in Österreich oder in einem sonstigen Vertragsstaat der ODR-VO niedergelassen sind, haben die Möglichkeit Probleme bezüglich dem entgeltlichen Kauf von Waren oder Dienstleistungen im Rahmen einer Online-Streitbeilegung (nach OS, AStG) zu lösen. Die Europäische Kommission stellt eine Plattform hierfür bereit: https://ec.europa.eu/consumers/odr\n\n\nUrheberrecht\n\n\nDie Inhalte dieser Webseite unterliegen, soweit dies rechtlich möglich ist, diversen Schutzrechten (z.B dem Urheberrecht). Jegliche Verwendung/Verbreitung von bereitgestelltem Material, welche urheberrechtlich untersagt ist, bedarf schriftlicher Zustimmung des Webseitenbetreibers.\n\n\nHaftungsausschluss\n\n\nTrotz sorgfältiger inhaltlicher Kontrolle übernimmt der Webseitenbetreiber dieser Webseite keine Haftung für die Inhalte externer Links. Für den Inhalt der verlinkten Seiten sind ausschließlich deren Betreiber verantwortlich. Sollten Sie dennoch auf ausgehende Links aufmerksam werden, welche auf eine Webseite mit rechtswidriger Tätigkeit/Information verweisen, ersuchen wir um dementsprechenden Hinweis, um diese nach § 17 Abs. 2 ECG umgehend zu entfernen. Die Urheberrechte Dritter werden vom Betreiber dieser Webseite mit größter Sorgfalt beachtet. Sollten Sie trotzdem auf eine Urheberrechtsverletzung aufmerksam werden, bitten wir um einen entsprechenden Hinweis. Bei Bekanntwerden derartiger Rechtsverletzungen werden wir den betroffenen Inhalt umgehend entfernen."
  }
]